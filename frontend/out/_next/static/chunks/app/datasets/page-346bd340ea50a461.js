(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[214],{12801:(e,t,s)=>{Promise.resolve().then(s.bind(s,20490))},20490:(e,t,s)=>{"use strict";s.d(t,{DatasetsView:()=>eQ});var a=s(95155),r=s(37777),n=s(53999);function l(e){let{data:t,className:s,chartHeightPx:l=96}=e,i=Math.max(...t);return(0,a.jsx)("div",{className:(0,n.cn)("flex w-64 items-end",s),style:{height:l},children:t.map((e,t)=>{var s,d,o;let{start:c,end:u}=(e=>{let t=new Date,s=new Date(t);s.setDate(t.getDate()-7*(11-e));let a=new Date(s);return a.setDate(s.getDate()-6),{start:a.toLocaleDateString(void 0,{month:"short",day:"numeric"}),end:s.toLocaleDateString(void 0,{month:"short",day:"numeric"})}})(t);return(0,a.jsxs)(r.m_,{delayDuration:0,children:[(0,a.jsx)(r.k$,{asChild:!0,children:(0,a.jsx)("div",{className:(0,n.cn)("flex flex-1 items-end px-0.5 brightness-100 transition hover:brightness-75 dark:hover:brightness-150"),style:{height:l},children:(0,a.jsx)("div",{className:"h-full w-full rounded-sm ".concat((e=>{switch(e){case 0:default:return"bg-muted";case 1:return"bg-green-200 dark:bg-green-900";case 2:return"bg-green-300 dark:bg-green-700";case 3:return"bg-green-400 dark:bg-green-600";case 4:return"bg-green-500 dark:bg-green-500"}})(0===e?0:e<=.25*i?1:e<=.5*i?2:e<=.75*i?3:4)),style:{height:(s=e,d=i,o=l,0===d?4:Math.max(4,s/d*o))}})})}),(0,a.jsx)(r.ZI,{children:(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsxs)("div",{className:"font-medium",children:[e," requests"]}),(0,a.jsxs)("div",{className:"text-muted-foreground",children:[c," - ",u]})]})})]},t)})})}var i=s(12115),d=s(74466);let o=(0,d.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function c(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,n.cn)(o({variant:s}),t),...r})}function u(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"alert-description",className:(0,n.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...s})}var m=s(16559),x=s(97168),h=s(88482),f=s(87489);function p(e){let{className:t,orientation:s="horizontal",decorative:r=!0,...l}=e;return(0,a.jsx)(f.b,{"data-slot":"separator",decorative:r,orientation:s,className:(0,n.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",t),...l})}var j=s(15452),g=s(54416);function v(e){let{...t}=e;return(0,a.jsx)(j.bL,{"data-slot":"sheet",...t})}function b(e){let{...t}=e;return(0,a.jsx)(j.ZL,{"data-slot":"sheet-portal",...t})}function N(e){let{className:t,...s}=e;return(0,a.jsx)(j.hJ,{"data-slot":"sheet-overlay",className:(0,n.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function y(e){let{className:t,children:s,side:r="right",...l}=e;return(0,a.jsxs)(b,{children:[(0,a.jsx)(N,{}),(0,a.jsxs)(j.UC,{"data-slot":"sheet-content",className:(0,n.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-300","right"===r&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm","left"===r&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm","top"===r&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b","bottom"===r&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",t),...l,children:[s,(0,a.jsxs)(j.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[(0,a.jsx)(g.A,{className:"size-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function w(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"sheet-header",className:(0,n.cn)("flex flex-col gap-1.5 p-4",t),...s})}function k(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"sheet-footer",className:(0,n.cn)("mt-auto flex flex-col gap-2 p-4",t),...s})}function D(e){let{className:t,...s}=e;return(0,a.jsx)(j.hE,{"data-slot":"sheet-title",className:(0,n.cn)("text-foreground font-semibold",t),...s})}function C(e){let{className:t,...s}=e;return(0,a.jsx)(j.VY,{"data-slot":"sheet-description",className:(0,n.cn)("text-muted-foreground text-sm",t),...s})}var S=s(57497),A=s(26715),E=s(5041),F=s(91788),z=s(62525),L=s(1243),$=s(99840),_=s(99708),q=s(62177),I=s(82714);let R=q.Op,O=i.createContext({}),U=e=>{let{...t}=e;return(0,a.jsx)(O.Provider,{value:{name:t.name},children:(0,a.jsx)(q.xI,{...t})})},P=()=>{let e=i.useContext(O),t=i.useContext(T),{getFieldState:s}=(0,q.xW)(),a=(0,q.lN)({name:e.name}),r=s(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:n}=t;return{id:n,name:e.name,formItemId:"".concat(n,"-form-item"),formDescriptionId:"".concat(n,"-form-item-description"),formMessageId:"".concat(n,"-form-item-message"),...r}},T=i.createContext({});function M(e){let{className:t,...s}=e,r=i.useId();return(0,a.jsx)(T.Provider,{value:{id:r},children:(0,a.jsx)("div",{"data-slot":"form-item",className:(0,n.cn)("grid gap-2",t),...s})})}function W(e){let{className:t,...s}=e,{error:r,formItemId:l}=P();return(0,a.jsx)(I.J,{"data-slot":"form-label","data-error":!!r,className:(0,n.cn)("transition data-[error=true]:text-red-500",t),htmlFor:l,...s})}function Z(e){let{...t}=e,{error:s,formItemId:r,formDescriptionId:n,formMessageId:l}=P();return(0,a.jsx)(_.DX,{"data-slot":"form-control",id:r,"aria-describedby":s?"".concat(n," ").concat(l):"".concat(n),"aria-invalid":!!s,...t})}function J(e){var t;let{icon:s,className:r,...l}=e,{error:i,formMessageId:d}=P(),o=i?String(null!=(t=null==i?void 0:i.message)?t:""):l.children;return o?(0,a.jsxs)("p",{"data-slot":"form-message",id:d,className:(0,n.cn)("text-xs leading-1 text-red-500",r),...l,children:[!1===s?null:null!=s?s:(0,a.jsx)(L.A,{className:"-mt-0.5 inline size-4 stroke-[2.5]"})," ",o]}):null}function K(e){let{className:t,type:s,...r}=e;return(0,a.jsx)("input",{type:s,"data-slot":"input",className:(0,n.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...r})}function V(e){let{className:t,...s}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,n.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...s})}var Q=s(11442),B=s(22235);let G=Q.Ay$.object({name:Q.Ay$.string().min(1,{message:"A dataset name is required"}),url:Q.Ay$.string().pipe(Q.Ay$.preprocess(e=>""===e||e.startsWith("https://")||e.startsWith("http://")?e:"https://"+e,Q.Ay$.url({protocol:/^(https?)?$/,hostname:Q.Ay$.regexes.domain,error:e=>""===e.input?"The store URL is required":void 0}))),pat:Q.Ay$.string().min(1,{message:"The access token is required"}).regex(/^shpat_[0-9a-f]{32}$/,{error:()=>"Invalid access token format"}),description:Q.Ay$.string().optional()}),H=Q.Ay$.object({name:Q.Ay$.string().optional(),description:Q.Ay$.string().optional()}),X={async getDatasets(){let e=await B.u.get("/api/v1/datasets"),t=await S.K.getJobs(),s=t.jobs.reduce((e,t)=>{let s=e.get(t.datasetName)||[];return e.set(t.datasetName,[...s,t]),e},new Map),a=t.jobs.reduce((e,t)=>{let s=e.get(t.datasetName)||new Set;return s.add(t.requesterEmail),e.set(t.datasetName,s),e},new Map),r=t.jobs.reduce((e,t)=>{var s;let a=(s=t.requestedTime,Math.floor((new Date().getTime()-s.getTime())/6048e5));if(a>=0&&a<12){let s=e.get(t.datasetName)||Array(12).fill(0);s[11-a]++,e.set(t.datasetName,s)}return e},new Map);return{datasets:e.datasets.map(e=>{var t,l;return{uid:e.uid,name:e.name,description:e.summary,size:(0,n.z3)(e.privateSize),type:e.private.split(".").pop()||"unknown",createdAt:new Date(e.createdAt),lastUpdated:new Date(e.updatedAt),accessRequests:0,permissions:[],usersCount:(null==(t=a.get(e.name))?void 0:t.size)||0,requestsCount:(null==(l=s.get(e.name))?void 0:l.length)||0,activityData:r.get(e.name)||Array(12).fill(0),source:e.source}})}},addShopifyDataset:e=>B.u.post("/api/v1/datasets/import-from-shopify",e),updateShopifyDataset:e=>{let{uid:t,data:s}=e;return B.u.put("/api/v1/datasets/update/".concat(t),s)},syncShopifyDataset:e=>B.u.put("/api/v1/datasets/sync-shopify-dataset/".concat(e),{}),getDatasetFiles:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"private";return B.u.get("/api/v1/datasets/files/".concat(e,"?dataset_type=").concat(t))}};var Y=s(57328),ee=s(90221),et=s(13717),es=s(51154),ea=s(4229),er=s(56671);function en(e){let{dataset:t}=e,s=(0,A.jE)(),r=(0,q.mN)({resolver:(0,ee.u)(H),defaultValues:{name:t.name,description:t.description}}),{setError:n}=r,l=(0,E.n)({mutationFn:X.updateShopifyDataset,onSuccess:()=>((0,er.oR)("Updated dataset"),s.invalidateQueries({queryKey:["datasets"]})),onError:e=>{e instanceof Y.ZM&&n(e.loc,{message:e.message}),e instanceof Y.hD&&(0,er.oR)("Error",{description:e.message})}}),{isPending:i}=l;return(0,a.jsxs)($.lG,{children:[(0,a.jsx)($.zM,{asChild:!0,children:(0,a.jsxs)(x.$,{variant:"outline",className:"w-full justify-start",children:[(0,a.jsx)(et.A,{className:"h-4 w-4"}),"Update Dataset"]})}),(0,a.jsxs)($.Cf,{children:[(0,a.jsx)($.c7,{children:(0,a.jsx)($.L3,{children:"Update Dataset"})}),(0,a.jsx)(R,{...r,children:(0,a.jsxs)("form",{onSubmit:r.handleSubmit(function(e){let s={...e,name:e.name!==t.name?e.name:void 0,description:e.description!==t.description?e.description:void 0};l.mutate({uid:t.uid,data:s})}),className:"flex flex-col gap-5",children:[(0,a.jsx)(U,{name:"name",render:e=>{let{field:s}=e;return(0,a.jsxs)(M,{children:[(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)(W,{children:"Dataset Name"}),(0,a.jsx)(J,{className:"absolute top-1 right-0"})]}),(0,a.jsx)(Z,{children:(0,a.jsx)(K,{placeholder:t.name,...s})})]})}}),(0,a.jsx)(U,{name:"description",render:e=>{let{field:s}=e;return(0,a.jsxs)(M,{children:[(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)(W,{children:"Description"}),(0,a.jsx)(J,{className:"absolute top-1 right-0"})]}),(0,a.jsx)(Z,{children:(0,a.jsx)(V,{placeholder:t.name,...s})})]})}}),(0,a.jsxs)($.Es,{children:[(0,a.jsx)($.HM,{asChild:!0,children:(0,a.jsx)(x.$,{type:"button",variant:"outline",onClick:()=>{r.reset()},disabled:i,children:"Cancel"})}),(0,a.jsx)(x.$,{type:"submit",disabled:i,children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(es.A,{className:"h-4 w-4 animate-spin"}),"Saving..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ea.A,{className:"h-4 w-4"}),"Save Change"]})})]})]})})]})]})}var el=s(32960),ei=s(16891),ed=s(88145),eo=s(34964),ec=s(38898),eu=s(21380),em=s(5196),ex=s(24357),eh=s(66474),ef=s(13052),ep=s(99890),ej=s(99903);function eg(e){let{dataset:t}=e,[s,r]=(0,i.useState)(!1),[l,d]=(0,i.useState)(null),[o,c]=(0,i.useState)(new Set),[u,m]=(0,i.useState)(!1),[h,f]=(0,i.useState)("private"),{data:p,isLoading:j}=(0,el.I)({queryKey:["dataset-files",t.uid,h],queryFn:()=>X.getDatasetFiles(t.uid,h),enabled:s}),g=(null==p?void 0:p.files)||{},v=Object.keys(g).sort(),b=function(e){let t=[];return e.forEach(e=>{let s=e.split("/"),a=t;s.forEach((e,t)=>{let r=t===s.length-1,n=s.slice(0,t+1).join("/"),l=a.find(t=>t.name===e);if(!l){let t={name:e,path:n,type:r?"file":"folder",children:r?void 0:[]};a.push(t),l=t}!r&&l.children&&(a=l.children)})}),t}(v);(0,i.useEffect)(()=>{!(v.length>0)||l||j||d(v[0])},[v.length,l,j]);let N=async e=>{try{await navigator.clipboard.writeText(e),m(!0),setTimeout(()=>m(!1),2e3)}catch(e){console.error("Failed to copy:",e)}};return(0,a.jsxs)($.lG,{open:s,onOpenChange:r,children:[(0,a.jsx)($.zM,{asChild:!0,children:(0,a.jsxs)(x.$,{variant:"outline",className:"w-full justify-start",children:[(0,a.jsx)(ec.A,{}),"View Dataset"]})}),(0,a.jsxs)($.Cf,{className:"!max-w-[50vw] !max-h-[90vh] !w-[50vw] !h-[90vh] p-5 !gap-0",children:[(0,a.jsxs)($.c7,{className:"!gap-1 !space-y-0 !mb-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)($.L3,{children:["Dataset Files: ",t.name]}),(0,a.jsx)(ed.E,{variant:"mock"===h?"default":"secondary",className:(0,n.cn)("text-xs","mock"===h?"bg-green-500 hover:bg-green-600 dark:bg-green-600 dark:hover:bg-green-700":"bg-orange-500 hover:bg-orange-600 dark:bg-orange-600 dark:hover:bg-orange-700"),children:"mock"===h?"Mock Data":"Private Data"})]}),(0,a.jsx)($.rr,{className:"!mb-0",children:"Browse and preview files in this dataset"})]}),(0,a.jsxs)(eo.tU,{value:h,onValueChange:e=>{f(e),d(null),c(new Set)},className:"w-full overflow-hidden !mt-0",children:[(0,a.jsxs)(eo.j7,{className:"!grid w-full grid-cols-2 !mt-0",children:[(0,a.jsx)(eo.Xi,{value:"private",className:"!flex-1",children:"Private Data"}),(0,a.jsx)(eo.Xi,{value:"mock",className:"!flex-1",children:"Mock Data"})]}),(0,a.jsx)(eo.av,{value:h,className:"mt-1",children:j?(0,a.jsx)("div",{className:"flex items-center justify-center h-[calc(90vh-190px)]",children:(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Loading ",h," data..."]})}):(0,a.jsxs)("div",{className:"flex gap-4 h-[calc(90vh-190px)] overflow-hidden",children:[(0,a.jsxs)("div",{className:"w-56 border-r pr-4 flex-shrink-0 flex flex-col",children:[(0,a.jsxs)("div",{className:"text-xs font-semibold mb-2 text-muted-foreground flex items-center gap-1",children:[(0,a.jsx)(eu.A,{className:"h-3 w-3"}),"Files"]}),(0,a.jsx)(ei.F,{className:"flex-1",children:j?(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Loading files..."}):0===v.length?(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"No files found"}):(0,a.jsx)(ev,{nodes:b,selectedFile:l,expandedFolders:o,onSelectFile:d,onToggleFolder:e=>{c(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},level:0})})]}),(0,a.jsx)("div",{className:"flex-1 min-w-0 overflow-hidden",children:l&&l in g?(0,a.jsxs)("div",{className:"h-full flex flex-col overflow-hidden",children:[(0,a.jsx)("div",{className:"text-xs font-medium mb-2 text-muted-foreground",children:l}),(0,a.jsx)("div",{className:"flex-1 rounded-md border bg-slate-950 overflow-hidden",children:(0,a.jsx)(ei.F,{className:"h-full w-full",children:(0,a.jsx)("div",{className:"p-4",style:{maxWidth:"100%",overflow:"hidden"},children:g[l]?g[l].startsWith("[")&&g[l].endsWith("]")?(0,a.jsx)("div",{className:"text-muted-foreground text-xs italic",children:g[l]}):l.endsWith(".csv")||l.endsWith(".tsv")?(0,a.jsx)("pre",{className:"text-xs text-slate-50 font-mono whitespace-pre-wrap",style:{overflowWrap:"anywhere",wordBreak:"break-word"},children:g[l]}):(0,a.jsx)(ej.X,{code:g[l],filePath:l}):(0,a.jsx)("div",{className:"text-muted-foreground text-xs italic",children:"This file is empty"})})})})]}):(0,a.jsx)("div",{className:"h-full flex items-center justify-center text-muted-foreground text-sm",children:j?"Loading files...":"Select a file to view its contents"})})]})})]}),(null==p?void 0:p.data_dir)&&(0,a.jsxs)("div",{className:"flex items-start gap-2 text-xs mt-2",children:[(0,a.jsx)("span",{className:"text-muted-foreground font-medium",children:"Dataset directory:"}),(0,a.jsx)("span",{className:"flex-1 break-all text-blue-500 underline",children:p.data_dir}),(0,a.jsx)(x.$,{variant:"ghost",size:"sm",className:"h-6 px-2 flex-shrink-0",onClick:()=>N(p.data_dir),children:u?(0,a.jsx)(em.A,{className:"h-3 w-3 text-green-500"}):(0,a.jsx)(ex.A,{className:"h-3 w-3"})})]})]})]})}function ev(e){let{nodes:t,selectedFile:s,expandedFolders:r,onSelectFile:l,onToggleFolder:i,level:d}=e;return(0,a.jsx)("div",{className:"space-y-0.5",children:t.map(e=>(0,a.jsx)("div",{children:"folder"===e.type?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>i(e.path),className:"w-full text-left text-xs px-2 py-1.5 rounded hover:bg-accent/50 transition-colors flex items-center gap-1",style:{paddingLeft:"".concat(12*d+8,"px")},children:[r.has(e.path)?(0,a.jsx)(eh.A,{className:"h-3 w-3 flex-shrink-0"}):(0,a.jsx)(ef.A,{className:"h-3 w-3 flex-shrink-0"}),(0,a.jsx)(eu.A,{className:"h-3 w-3 flex-shrink-0 text-blue-500"}),(0,a.jsx)("span",{className:"truncate font-medium",children:e.name})]}),r.has(e.path)&&e.children&&(0,a.jsx)(ev,{nodes:e.children,selectedFile:s,expandedFolders:r,onSelectFile:l,onToggleFolder:i,level:d+1})]}):(0,a.jsxs)("button",{onClick:()=>l(e.path),className:(0,n.cn)("w-full text-left text-xs px-2 py-1.5 rounded hover:bg-accent transition-colors flex items-center gap-1",s===e.path&&"bg-accent font-medium"),style:{paddingLeft:"".concat(12*d+8,"px")},children:[(0,a.jsx)(ep.A,{className:"h-3 w-3 flex-shrink-0 text-gray-500"}),(0,a.jsx)("span",{className:"truncate",children:e.name})]})},e.path))})}function eb(e){let{dataset:t,open:s,onOpenChange:r}=e,[n,d]=(0,i.useState)(!1),[o,f]=(0,i.useState)(""),[j,g]=(0,i.useState)(!1),b=(0,A.jE)(),N=(0,E.n)({mutationFn:e=>{let{datasetName:t}=e;return S.K.deleteDataset(t)},onError:e=>{console.error(e)},onSuccess:()=>{b.invalidateQueries({queryKey:["datasets"]}),r(!1),er.oR.success("Success",{description:"Removed dataset"})}}),$=async()=>{if(t){d(!0),f("");try{let e=await S.K.downloadDatasetPrivate(t.uid),s=await e.blob(),a=window.URL.createObjectURL(s),n=document.createElement("a");n.href=a;let l=e.headers.get("Content-Disposition"),i=null==l?void 0:l.match(/filename="(.+)"/);n.download=i?i[1]:"".concat(t.name,".csv"),document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(a),document.body.removeChild(n),er.oR.success("Dataset downloaded successfully"),r(!1)}catch(e){f(e instanceof Error?e.message:"Failed to download dataset")}finally{d(!1)}}};return t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v,{open:s,onOpenChange:r,children:(0,a.jsxs)(y,{className:"scrollbar-thin overflow-y-auto",children:[(0,a.jsxs)(w,{children:[(0,a.jsx)(D,{className:"text-2xl",children:t.name}),(0,a.jsx)(C,{children:t.description})]}),(0,a.jsxs)("div",{className:"flex-1",children:[o&&(0,a.jsx)(c,{variant:"destructive",className:"mb-4",children:(0,a.jsx)(u,{className:"break-all",children:o})}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 px-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-muted-foreground",children:"Format"}),(0,a.jsx)("div",{className:"font-medium",children:t.type.toUpperCase()})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-muted-foreground",children:"Size"}),(0,a.jsx)("div",{className:"font-medium",children:t.size})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-muted-foreground",children:"Created"}),(0,a.jsx)("div",{className:"font-medium",children:new Date(t.createdAt).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-muted-foreground",children:"Last Updated"}),(0,a.jsx)("div",{className:"font-medium",children:new Date(t.lastUpdated).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})})]})]}),(0,a.jsxs)(h.Zp,{children:[(0,a.jsx)(h.aR,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(h.ZB,{className:"text-sm font-medium",children:"Activity Overview"}),(0,a.jsx)("div",{className:"text-muted-foreground text-xs",children:"Last 12 weeks"})]})}),(0,a.jsxs)(h.Wu,{children:[(0,a.jsx)(l,{data:t.activityData,className:"w-full",chartHeightPx:128}),(0,a.jsxs)("div",{className:"text-muted-foreground mt-4 flex items-center justify-between text-xs",children:[(0,a.jsx)("div",{children:"Total Requests: 1"}),(0,a.jsx)("div",{children:"Avg: 0/week"})]})]})]})]})]}),(0,a.jsxs)(k,{children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"text-sm font-medium",children:"Actions"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(x.$,{variant:"outline",className:"w-full justify-start",onClick:$,disabled:n,children:[(0,a.jsx)(F.A,{className:"h-4 w-4"}),"Download Dataset"]}),(0,a.jsx)(eg,{dataset:t}),(0,a.jsx)(en,{dataset:t}),(0,a.jsxs)(x.$,{variant:"outline",className:"w-full justify-start text-red-600 hover:bg-red-50 hover:text-red-700",onClick:()=>g(!0),disabled:n,children:[(0,a.jsx)(z.A,{className:"h-4 w-4"}),"Delete Dataset"]})]})]}),(0,a.jsx)(p,{className:"my-2"}),(0,a.jsx)(x.$,{variant:"outline",onClick:()=>r(!1),className:"w-full",children:"Close"})]})]})}),(0,a.jsx)(m.Lt,{open:j,onOpenChange:g,children:(0,a.jsxs)(m.EO,{children:[(0,a.jsxs)(m.wd,{children:[(0,a.jsxs)(m.r7,{className:"flex items-center gap-2",children:[(0,a.jsx)(L.A,{className:"h-5 w-5 text-red-500"}),"Delete Dataset"]}),(0,a.jsxs)(m.$v,{children:["Are you sure you want to delete"," ",(0,a.jsx)("span",{className:"font-semibold",children:t.name}),"? This action cannot be undone."]})]}),(0,a.jsxs)(m.ck,{children:[(0,a.jsx)(m.Zr,{children:"Cancel"}),(0,a.jsx)(m.Rx,{onClick:()=>t&&N.mutate({datasetName:t.name}),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]}):null}var eN=s(27737),ey=s(50883),ew=s(54213),ek=s(65112),eD=s(17580),eC=s(72713),eS=s(69074),eA=s(95880),eE=s(64315);function eF(e){let{children:t,className:s,...r}=e;return(0,a.jsx)("div",{...r,className:(0,n.cn)("flex cursor-default items-center gap-1.5 space-x-1 whitespace-nowrap rounded-sm bg-transparent px-2 py-0.5 text-sm text-muted-foreground transition-colors hover:bg-muted hover:text-foreground [&>svg]:pointer-events-none [&>svg]:mb-px [&>svg]:size-4",s),children:t})}var ez=s(53904);function eL(e){let{dataset:t}=e,s=(0,A.jE)(),r=(0,i.useRef)(null),n=(0,E.n)({mutationFn:X.syncShopifyDataset,onSuccess:()=>{er.oR.success("Dataset synced successfully")},onSettled:()=>(r.current&&(r.current.style.animationIterationCount="1"),s.invalidateQueries({queryKey:["datasets"]}))}),{isPending:l}=n;return(0,a.jsxs)(x.$,{size:"sm",variant:"outline",onClick:()=>{(()=>{let e=r.current;if(!e)return;e.classList.remove("animate-spin"),e.offsetHeight,e.style.animationIterationCount="infinite",e.classList.add("animate-spin");let t=()=>{e.classList.remove("animate-spin"),e.removeEventListener("animationend",t)};e.addEventListener("animationend",t)})(),n.mutate(t.uid)},disabled:l,children:[(0,a.jsx)("span",{ref:r,className:"inline-flex duration-500",children:(0,a.jsx)(ez.A,{})}),"Sync"]})}function e$(e){var t,s;let{dataset:i,onSelect:d}=e;return(0,a.jsx)(h.Zp,{children:(0,a.jsxs)(h.Wu,{className:"flex justify-between",children:[(0,a.jsxs)("div",{className:"flex flex-1 flex-col justify-between gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-1 flex items-center gap-3",children:[(0,a.jsx)("h3",{className:"cursor-pointer text-xl font-semibold text-blue-600 hover:underline",onClick:d,children:i.name}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsxs)(r.m_,{children:[(0,a.jsx)(r.k$,{asChild:!0,children:(0,a.jsxs)(ed.E,{variant:"secondary",className:"cursor-default gap-2 bg-green-100 text-green-800 transition-colors hover:bg-green-200 hover:text-green-900 dark:bg-green-900 dark:text-green-300 dark:hover:bg-green-800 dark:hover:text-green-100",children:[(0,a.jsx)(ek.A,{size:12})," ",i.type.toUpperCase()]})}),(0,a.jsxs)(r.ZI,{children:["Dataset format: ",i.type.toUpperCase()]})]}),(null==(t=i.source)?void 0:t.type)==="shopify"?(0,a.jsxs)(r.m_,{children:[(0,a.jsx)(r.k$,{asChild:!0,children:(0,a.jsxs)(ed.E,{variant:"outline",className:"hover:bg-muted dark:hover:bg-muted cursor-default gap-2 transition-colors",children:[(0,a.jsx)(eE.M2,{size:14})," Shopify"]})}),(0,a.jsx)(r.ZI,{children:"Dataset linked from Shopify"})]}):null]})]}),(0,a.jsx)(h.BT,{className:"text-muted-foreground text-sm",children:i.description})]}),(0,a.jsxs)("div",{className:"-mb-1 -ml-2 flex flex-wrap gap-1",children:[(0,a.jsxs)(r.m_,{children:[(0,a.jsx)(r.k$,{asChild:!0,children:(0,a.jsxs)(eF,{children:[(0,a.jsx)(eD.A,{className:"h-4 w-4 shrink-0"}),"".concat(i.usersCount," ").concat(1===i.usersCount?"user":"users")]})}),(0,a.jsxs)(r.ZI,{collisionPadding:8,children:[i.usersCount," ",1===i.usersCount?"user has":"users have"," requested access to this dataset"]})]}),(0,a.jsxs)(r.m_,{children:[(0,a.jsx)(r.k$,{asChild:!0,children:(0,a.jsxs)(eF,{children:[(0,a.jsx)(eC.A,{className:"h-4 w-4 shrink-0"}),i.requestsCount," requests"]})}),(0,a.jsxs)(r.ZI,{children:[i.requestsCount," total access",1===i.requestsCount?" request":" requests"]})]}),(0,a.jsxs)(r.m_,{children:[(0,a.jsx)(r.k$,{asChild:!0,children:(0,a.jsxs)(eF,{children:[(0,a.jsx)(eS.A,{className:"h-4 w-4 shrink-0"}),"Updated ",(0,n.fF)(i.lastUpdated.toISOString())]})}),(0,a.jsxs)(r.ZI,{children:["Last updated on"," ",i.lastUpdated.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),(0,a.jsxs)(r.m_,{children:[(0,a.jsx)(r.k$,{asChild:!0,children:(0,a.jsxs)(eF,{children:[(0,a.jsx)(eA.A,{className:"h-4 w-4 shrink-0"}),i.size]})}),(0,a.jsxs)(r.ZI,{children:["The dataset is ",i.size," in size"]})]})]}),i.permissions.length>0?(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:i.permissions.map((e,t)=>(0,a.jsx)(ed.E,{variant:"outline",className:"bg-muted text-xs",children:e},t))}):null]}),(0,a.jsx)("div",{className:"mr-2 flex flex-col justify-end",children:(null==(s=i.source)?void 0:s.type)==="shopify"?(0,a.jsx)(eL,{dataset:i}):null}),(0,a.jsx)(l,{data:i.activityData})]})})}var e_=s(67133),eq=s(84616),eI=s(42148),eR=s(23837);function eO(e){let{open:t,onOpenChange:s}=e,r=(0,A.jE)(),n=(0,q.mN)({resolver:(0,ee.u)(G),defaultValues:{name:"",url:"",pat:"",description:""}}),{setError:l}=n,i=(0,E.n)({mutationFn:X.addShopifyDataset,onError:e=>{e instanceof Y.ZM&&l(e.loc,{message:e.message}),e instanceof Y.hD&&(0,er.oR)("Error",{description:e.message})},onSuccess:()=>(s(!1),n.reset(),(0,er.oR)("Imported data from Shopify"),r.invalidateQueries({queryKey:["datasets"]}))}),{isPending:d}=i;return(0,a.jsx)($.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)($.Cf,{className:"sm:max-w-md",children:[(0,a.jsx)($.c7,{children:(0,a.jsx)($.L3,{children:"Import data from your Shopify store"})}),(0,a.jsx)(R,{...n,children:(0,a.jsxs)("form",{onSubmit:n.handleSubmit(function(e){i.mutate(e)}),className:"flex flex-col gap-5",children:[(0,a.jsx)(U,{name:"name",render:e=>{let{field:t}=e;return(0,a.jsxs)(M,{children:[(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)(W,{children:"Dataset Name *"}),(0,a.jsx)(J,{className:"absolute top-1 right-0"})]}),(0,a.jsx)(Z,{children:(0,a.jsx)(K,{placeholder:"shopify_data",...t})})]})}}),(0,a.jsx)(U,{name:"description",render:e=>{let{field:t}=e;return(0,a.jsxs)(M,{children:[(0,a.jsx)(W,{children:"Description (optional)"}),(0,a.jsx)(Z,{children:(0,a.jsx)(V,{placeholder:"Data from ...",...t})})]})}}),(0,a.jsx)(U,{name:"url",render:e=>{let{field:t}=e;return(0,a.jsxs)(M,{children:[(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)(W,{children:"Shopify Store URL *"}),(0,a.jsx)(J,{className:"absolute top-1 right-0"})]}),(0,a.jsx)(Z,{children:(0,a.jsx)(K,{placeholder:"https://your-store.com",...t})})]})}}),(0,a.jsx)(U,{name:"pat",render:e=>{let{field:t}=e;return(0,a.jsxs)(M,{children:[(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)(W,{children:"Access Token *"}),(0,a.jsx)(J,{className:"absolute top-1 right-0"})]}),(0,a.jsx)(Z,{children:(0,a.jsx)(K,{placeholder:"shpat_123...",...t})})]})}}),(0,a.jsxs)($.Es,{children:[(0,a.jsx)(x.$,{type:"button",variant:"outline",onClick:()=>{s(!1),n.reset()},disabled:d,children:"Cancel"}),(0,a.jsx)(x.$,{type:"submit",disabled:d,children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(es.A,{className:"h-4 w-4 animate-spin"}),"Importing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eR.A,{className:"h-4 w-4"}),"Import"]})})]})]})})]})})}var eU=s(14395),eP=s(29869),eT=s(42493);let eM=(0,d.F)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-8 px-2",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),eW=i.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(eT.bL,{ref:t,className:(0,n.cn)("flex items-center justify-center gap-1",s),...r})});eW.displayName=eT.bL.displayName;let eZ=i.forwardRef((e,t)=>{let{className:s,variant:r,size:l,...i}=e;return(0,a.jsx)(eT.q7,{ref:t,className:(0,n.cn)(eM({variant:r,size:l,className:s})),...i})});eZ.displayName=eT.q7.displayName;var eJ=s(64331);function eK(e){let{open:t,onOpenChange:s,onSuccess:r}=e,[n,l]=(0,i.useState)(null),[d,o]=(0,i.useState)(null),[m,h]=(0,i.useState)(null),[f,p]=(0,i.useState)(null),[j,g]=(0,i.useState)(""),[v,b]=(0,i.useState)(""),[N,y]=(0,i.useState)(!1),[w,k]=(0,i.useState)(""),[D,C]=(0,i.useState)("file"),[F,z]=(0,i.useState)("file"),{isDragging:L,activeDropZone:_,handleDragEnter:q,handleDragLeave:R,handleDragOver:O,handleDrop:U}=(0,eJ.J)(),P=(0,A.jE)(),T=(0,E.n)({mutationFn:S.K.createDataset,onSuccess:e=>{P.invalidateQueries({queryKey:["datasets"]}),er.oR.success("New dataset created"),null==r||r()}}),M=e=>{U(e,"create-dataset",e=>{l(e),g(e.name.replace(/\.[^/.]+$/,""))})},W=e=>{let t=e.target.files;if(t&&t.length>0){h(t),l(t[0]);let e=t[0];e.webkitRelativePath?g(e.webkitRelativePath.split("/")[0]):g(e.name.replace(/\.[^/.]+$/,""))}},Z=e=>{let t=e.target.files;t&&t.length>0&&(p(t),o(t[0]))},J=async e=>{if(e.preventDefault(),!m||0===m.length)return void k("Please select a file or folder");if(!j.trim())return void k("Please enter a dataset name");if(!f||0===f.length)return void k("Mock dataset file or folder is required");y(!0),k("");try{let e=new FormData;Array.from(m).forEach(t=>{e.append("dataset",t,t.webkitRelativePath||t.name)}),e.append("name",j.trim()),e.append("description",v.trim()||""),Array.from(f).forEach(t=>{e.append("mock_dataset",t,t.webkitRelativePath||t.name)}),T.mutate(e)}catch(e){k(e instanceof Error?e.message:"Failed to create dataset")}finally{y(!1)}},V=e=>{e||N||(l(null),o(null),h(null),p(null),g(""),b(""),k(""),y(!1)),s(e)};return(0,a.jsx)($.lG,{open:t,onOpenChange:V,children:(0,a.jsxs)($.Cf,{className:"sm:max-w-md",onDragEnter:e=>q(e,"create-dataset"),onDragLeave:e=>R(e,"create-dataset"),onDragOver:e=>O(e,"create-dataset"),onDrop:M,children:[(0,a.jsxs)($.c7,{children:[(0,a.jsx)($.L3,{children:"Create New Dataset"}),(0,a.jsx)($.rr,{children:"Get started by uploading your dataset file."})]}),(0,a.jsxs)("form",{onSubmit:J,className:"space-y-4",onDragEnter:e=>q(e,"create-dataset"),onDragLeave:e=>R(e,"create-dataset"),onDragOver:e=>O(e,"create-dataset"),onDrop:M,children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(I.J,{htmlFor:"dataset-file",children:"Dataset *"}),(0,a.jsxs)(eW,{type:"single",value:D,onValueChange:e=>{e&&(C(e),l(null),h(null))},children:[(0,a.jsxs)(eZ,{value:"file",size:"sm",children:[(0,a.jsx)(ep.A,{className:"mr-1 h-3 w-3"}),"Single file"]}),(0,a.jsxs)(eZ,{value:"folder",size:"sm",children:[(0,a.jsx)(eu.A,{className:"mr-1 h-3 w-3"}),"Entire folder"]})]})]}),(0,a.jsxs)("div",{className:"relative rounded-lg border-2 border-dashed p-6 text-center transition-colors ".concat("create-dataset"===_&&L?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-muted-foreground/50"),children:["file"===D?(0,a.jsx)("input",{id:"dataset-file",type:"file",onChange:W,className:"hidden",multiple:!0}):(0,a.jsx)("input",{id:"dataset-folder",type:"file",onChange:W,className:"hidden",webkitdirectory:"",directory:"",multiple:!0}),(0,a.jsx)("label",{htmlFor:"file"===D?"dataset-file":"dataset-folder",className:"block cursor-pointer",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eU.A,{className:"text-muted-foreground mx-auto h-8 w-8"}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"text-primary font-medium hover:underline",children:"create-dataset"===_&&L?"Drop your file here":"Drop your file here or click to select"}),(0,a.jsxs)("p",{className:"text-muted-foreground mt-1",children:["Choose your dataset ",D]})]})]})})]}),m&&(0,a.jsxs)("p",{className:"text-muted-foreground text-sm",children:["Selected: ",m.length>1?"".concat(m.length," files"):null==n?void 0:n.name]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(I.J,{htmlFor:"mock-dataset-file",children:"Mock Dataset *"}),(0,a.jsxs)(eW,{type:"single",value:F,onValueChange:e=>{e&&(z(e),o(null),p(null))},children:[(0,a.jsxs)(eZ,{value:"file",size:"sm",children:[(0,a.jsx)(ep.A,{className:"mr-1 h-3 w-3"}),"Single file"]}),(0,a.jsxs)(eZ,{value:"folder",size:"sm",children:[(0,a.jsx)(eu.A,{className:"mr-1 h-3 w-3"}),"Entire folder"]})]})]}),(0,a.jsxs)("div",{className:"relative rounded-lg border-2 border-dashed p-6 text-center transition-colors ".concat("create-mock-dataset"===_&&L?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-muted-foreground/50"),onDragEnter:e=>q(e,"create-mock-dataset"),onDragLeave:e=>R(e,"create-mock-dataset"),onDragOver:e=>O(e,"create-mock-dataset"),onDrop:e=>{U(e,"create-mock-dataset",e=>{o(e)})},children:["file"===F?(0,a.jsx)("input",{id:"mock-dataset-file",type:"file",onChange:Z,className:"hidden",multiple:!0}):(0,a.jsx)("input",{id:"mock-dataset-folder",type:"file",onChange:Z,className:"hidden",webkitdirectory:"",directory:"",multiple:!0}),(0,a.jsx)("label",{htmlFor:"file"===F?"mock-dataset-file":"mock-dataset-folder",className:"block cursor-pointer",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eU.A,{className:"text-muted-foreground mx-auto h-8 w-8"}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"text-primary font-medium hover:underline",children:"create-mock-dataset"===_&&L?"Drop your mock file here":"Drop your mock file here or click to select"}),(0,a.jsxs)("p",{className:"text-muted-foreground mt-1",children:["Choose your mock dataset ",F]})]})]})})]}),f&&(0,a.jsxs)("p",{className:"text-muted-foreground text-sm",children:["Selected: ",f.length>1?"".concat(f.length," files"):null==d?void 0:d.name]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(I.J,{htmlFor:"name",children:"Dataset Name *"}),(0,a.jsx)(K,{id:"name",value:j,onChange:e=>g(e.target.value),placeholder:"Enter dataset name",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(I.J,{htmlFor:"description",children:"Description (optional)"}),(0,a.jsx)(K,{id:"description",value:v,onChange:e=>b(e.target.value),placeholder:"Brief description of the dataset"})]}),w&&(0,a.jsx)(c,{variant:"destructive",children:(0,a.jsx)(u,{className:"break-all",children:w})}),(0,a.jsxs)($.Es,{children:[(0,a.jsx)(x.$,{type:"button",variant:"outline",onClick:()=>V(!1),disabled:N,children:"Cancel"}),(0,a.jsx)(x.$,{type:"submit",disabled:N,children:N?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(es.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Uploading..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eP.A,{className:"mr-2 h-4 w-4"}),"Create Dataset"]})})]})]})]})})}function eV(){let[e,t]=(0,i.useState)(!1),[s,r]=(0,i.useState)(!1);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(e_.rI,{children:[(0,a.jsx)(e_.ty,{asChild:!0,children:(0,a.jsxs)(x.$,{size:"sm",children:[(0,a.jsx)(eq.A,{}),"Add a Dataset"]})}),(0,a.jsxs)(e_.SQ,{align:"end",children:[(0,a.jsxs)(e_._2,{className:"cursor-pointer px-3",onSelect:()=>r(!0),children:[(0,a.jsx)(eI.A,{className:"size-4"}),"Add from a local file"]}),(0,a.jsxs)(e_._2,{className:"cursor-pointer px-3",onSelect:()=>t(!0),children:[(0,a.jsx)(eE.M2,{className:"size-4"}),"Import from Shopify"]})]})]}),(0,a.jsx)(eO,{open:e,onOpenChange:t}),(0,a.jsx)(eK,{open:s,onOpenChange:r,onSuccess:()=>r(!1)})]})}function eQ(){let[e,t]=(0,i.useState)(null),[s,r]=(0,i.useState)(!1),{isPending:n,data:l}=(0,el.I)({queryKey:["datasets"],queryFn:()=>X.getDatasets(),refetchInterval:ey.c.REFETCH_INTERVAL,refetchOnWindowFocus:ey.c.REFETCH_ON_WINDOW_FOCUS});return(0,i.useEffect)(()=>{if(!e||!l)return;let s=l.datasets.find(t=>t.uid===e.uid);s&&t(s)},[l]),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Datasets"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage your cooperative's data assets"})]}),(0,a.jsx)(eV,{})]}),n||!l?(0,a.jsx)(eB,{}):(0,a.jsx)("div",{className:"space-y-4",children:0===l.datasets.length?(0,a.jsxs)("div",{className:"mx-auto flex h-96 max-w-md flex-col items-center justify-center",children:[(0,a.jsx)(ew.A,{className:"text-muted-foreground mb-6 size-16",strokeWidth:1.5}),(0,a.jsx)("h3",{className:"text-foreground text-lg font-medium",children:"No datasets found"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-6",children:"Add a new dataset to get started"})]}):l.datasets.map(e=>(0,a.jsx)(e$,{dataset:e,onSelect:()=>{t(e),r(!0)}},e.uid))}),(0,a.jsx)(eb,{dataset:e,open:s,onOpenChange:()=>{r(!1),setTimeout(()=>t(null),350)}})]})}function eB(){return(0,a.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,t)=>(0,a.jsx)(h.Zp,{children:(0,a.jsxs)(h.Wu,{className:"flex justify-between p-6",children:[(0,a.jsxs)("div",{className:"flex w-2/3 flex-col justify-between gap-1",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eN.E,{className:"bg-muted h-6 w-1/3 rounded"}),(0,a.jsx)(eN.E,{className:"bg-muted h-4 w-2/3 rounded"})]}),(0,a.jsxs)("div",{className:"flex h-4 gap-2",children:[(0,a.jsx)(eN.E,{className:"h-full w-20"}),(0,a.jsx)(eN.E,{className:"h-full w-20"}),(0,a.jsx)(eN.E,{className:"h-full w-48"}),(0,a.jsx)(eN.E,{className:"h-full w-20"})]})]}),(0,a.jsx)(eN.E,{className:"bg-muted h-24 w-64 rounded"})]})},t))})}},64331:(e,t,s)=>{"use strict";s.d(t,{J:()=>l,X:()=>i});var a=s(95155),r=s(12115);let n=(0,r.createContext)(null);function l(){let e=(0,r.useContext)(n);if(!e)throw Error("useDragDrop must be used within a DragDropProvider");return e}function i(e){let{children:t}=e,[s,l]=(0,r.useState)(!1),[i,d]=(0,r.useState)(null),o=(0,r.useCallback)((e,t)=>{e.preventDefault(),e.stopPropagation(),l(!0),d(t)},[]),c=(0,r.useCallback)((e,t)=>{e.preventDefault(),e.stopPropagation(),i===t&&(l(!1),d(null))},[i]),u=(0,r.useCallback)((e,t)=>{e.preventDefault(),e.stopPropagation(),l(!0),d(t)},[]),m=(0,r.useCallback)((e,t,s)=>{e.preventDefault(),e.stopPropagation(),l(!1),d(null);let a=e.dataTransfer.files;a&&a.length>0&&s(a[0])},[]);return(0,a.jsx)(n.Provider,{value:{isDragging:s,activeDropZone:i,setActiveDropZone:d,handleDragEnter:o,handleDragLeave:c,handleDragOver:u,handleDrop:m},children:t})}},67133:(e,t,s)=>{"use strict";s.d(t,{SQ:()=>d,_2:()=>o,lp:()=>c,mB:()=>u,rI:()=>l,ty:()=>i});var a=s(95155);s(12115);var r=s(26317),n=s(53999);function l(e){let{...t}=e;return(0,a.jsx)(r.bL,{"data-slot":"dropdown-menu",...t})}function i(e){let{...t}=e;return(0,a.jsx)(r.l9,{"data-slot":"dropdown-menu-trigger",...t})}function d(e){let{className:t,sideOffset:s=4,...l}=e;return(0,a.jsx)(r.ZL,{children:(0,a.jsx)(r.UC,{"data-slot":"dropdown-menu-content",sideOffset:s,className:(0,n.cn)("max-h-(--radix-dropdown-menu-content-available-height) origin-(--radix-dropdown-menu-content-transform-origin) z-50 min-w-32 overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...l})})}function o(e){let{className:t,inset:s,variant:l="default",...i}=e;return(0,a.jsx)(r.q7,{"data-slot":"dropdown-menu-item","data-inset":s,"data-variant":l,className:(0,n.cn)("[svg]:*:data-[variant=destructive]:text-destructive! outline-hidden relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm focus:bg-accent focus:text-accent-foreground data-disabled:pointer-events-none data-inset:pl-8 data-[variant=destructive]:text-destructive data-disabled:opacity-50 data-[variant=destructive]:focus:bg-destructive/10 data-[variant=destructive]:focus:text-destructive dark:data-[variant=destructive]:focus:bg-destructive/20 [&_svg:not([class*='size-'])]:size-4 [&_svg:not([class*='text-'])]:text-muted-foreground [&_svg]:pointer-events-none [&_svg]:shrink-0",t),...i})}function c(e){let{className:t,inset:s,...l}=e;return(0,a.jsx)(r.JU,{"data-slot":"dropdown-menu-label","data-inset":s,className:(0,n.cn)("px-2 py-1.5 text-sm font-medium data-inset:pl-8",t),...l})}function u(e){let{className:t,...s}=e;return(0,a.jsx)(r.wv,{"data-slot":"dropdown-menu-separator",className:(0,n.cn)("-mx-1 my-1 h-px bg-border",t),...s})}},82714:(e,t,s)=>{"use strict";s.d(t,{J:()=>l});var a=s(95155);s(12115);var r=s(40968),n=s(53999);function l(e){let{className:t,...s}=e;return(0,a.jsx)(r.b,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...s})}}},e=>{e.O(0,[446,529,288,95,511,696,441,964,358],()=>e(e.s=12801)),_N_E=e.O()}]);